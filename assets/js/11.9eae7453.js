(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{82:function(t,n,e){"use strict";e.r(n);var i=e(0),a=Object(i.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"未使用事件委托实现vue手风琴"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#未使用事件委托实现vue手风琴","aria-hidden":"true"}},[t._v("#")]),t._v(" 未使用事件委托实现vue手风琴")]),e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("uvar Vue = require('vue-plus');\nvar config = require('config');\n\nvar component = Vue.extend({\n\n\tdata: function() {\n\t\treturn {\n\t\t\tlist: [],\n\t\t\tpage: 1,\n\t\t\thasMore: true,\n\t\t\tisShowLoading: false,\n\t\t\tloadingTip: '',\n\t\t\t// 详情数据数组\n\t\t\tinfos: [],\n\t\t\tcurrent: {},\n\t\t\trate: 0\n\t\t};\n\t},\n\n\ttemplate: __inline('./list.tpl'),\n\n\tmethods: {\n\t\ttoggleDetail: function ($event, ctime, which) {\n\t\t\t// 获取当前元素,即当前列表项\n\t\t\tvar $curr = $event.currentTarget;\n\t\t\t// 返回列表项的下一个同胞（位于同一列表中）\n\t\t\tvar currentItem = $curr.nextElementSibling;\n\t\t\t// 获取下一列表项的display属性\n\t\t\tvar display = currentItem.style.display;\n\t\t\t// 获取当前列表项的第一个子元素的第二个子元素，即img旋转图标\n\t\t\tvar img = $event.currentTarget.children[0].children[1];\n\t\t\t// 获取所有详情数据模块，结果为一个数组\n\t\t\tvar $details = document.querySelectorAll('.bg-fcfcfc');\n\t\t\t// 获取所有旋转图标，结果为一个数组\n\t\t\tvar $imgs = document.querySelectorAll('.angle');\n\n\t\t\t// 循环详情数组，（当点击此列表时，）如果此详情数组是显示的，那就让它隐藏，实现切换，同时改变旋转图标的样式\n\t\t\tfor(var i = 0, l = $details.length; i < l; i++) {\n\t\t\t\tif($details[i].style.display === '') {\n\t\t\t\t\t$details[i].style.display = 'none';\n\t\t\t\t\t$imgs[i].className        = 'angle fr';\n\t\t\t\t}\n\t\t\t}\n\n\t\t// 如果下一列表项是隐藏的，\n\t\t\tif(display === 'none') {\n\t\t\t\t//显示\n\t\t\t\t// 如果当前详情项在列表详情数组里为未空，那就请求接口\n\t\t\t\tif(!this.infos[which]) {\n\t\t\t\t\tvar promise = Vue.ajax({\n\t\t\t\t\t\t\turl: 'http://qlll.dev.zhongfl.com/api/account/Interestdetail',\n\t\t\t\t\t\t\tmethod: 'post',\n\t\t\t\t\t\t\t// 提交列表项的时间\n\t\t\t\t\t\t\tdata: {date: ctime}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.success(reqSuccess(function(resp) {\n\t\t\t\t\t\t\t// 将请求数据赋值给当前详情列表中对应当前条目的那一项\n\t\t\t\t\t\t\tthis.infos[which] = resp.data;\n\t\t\t\t\t\t\t// 将请求数据赋值给当前详情项\n\t\t\t\t\t\t\tthis.current = resp.data;\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\tif(!resp.data.activity){\n\t\t\t\t\t\t\t\tthis.rate = 0;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.rate = resp.data.activity.rate;\n\t\t\t\t\t\t\t\tcurrentItem.style.display = '';\n\t\t\t\t\t\t\t\timg.className = 'angle fr angleRotate';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this));\n\t\t\t\t} else {\n\t\t\t\t\tthis.current = this.infos[which];\n\t\t\t\t\tcurrentItem.style.display = '';\n\t\t\t\t\timg.className = 'angle fr angleRotate';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//隐藏\n\t\t\t\timg.className = 'angle fr';\n\t\t\t\tcurrentItem.style.display = 'none';\n\t\t\t}\n\t\t},\n\n\t\tonScrollBottom: function() {\n\t\t\tif (isBottomOnScroll()) {\n\t\t\t\tif (this.hasMore) {\n\t\t\t\t\tthis.fetchData();\n\t\t\t\t} else {\n\t\t\t\t\twindow.onscroll = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tfetchData: function() {\n\t\t\tthis.isShowLoading = true;\n\t\t\tthis.loadingTip  = '正在加载...';\n\t\t\tvar promise = Vue.ajax({\n\t\t\t\turl: 'http://qlll.dev.zhongfl.com/api/account/interestlist',\n\t\t\t\tmethod: 'get',\n\t\t\t\tdata: {\n\t\t\t\t\tpage: this.page,\n\t\t\t\t\tlen: 15\t\t\t//安卓手机列表第一页数据过少导致不能滚动。\n\t\t\t\t}\n\t\t\t})\n\t\t\t.success(reqSuccess(function(resp) {\n\t\t\t\tvar list = resp.data.list;\n\t\t\t\tif (list.length > 0) {\n\t\t\t\t\tthis.isShowLoading = false;\n\t\t\t\t\tthis.list = this.list.concat(list);\n\t\t\t\t\tthis.page += 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.isShowLoading = true;\n\t\t\t\t\tthis.loadingTip = '没有更多数据了';\n\t\t\t\t\tthis.hasMore = false;\n\t\t\t\t}\n\t\t\t}, this));\n\t\t}\n\t},\n\n\tready: function() {\n\t\tthis.fetchData();\n\t\twindow.onscroll = this.onScrollBottom.bind(this);\n\t\tvar $details = document.querySelectorAll('.bg-fcfcfc');\n\t\tvar $imgs    = document.querySelectorAll('.angle');\n\n\t\tfor(var i = 0, l = $details.length; i < l; i++) {\n\t\t\t$details[i].style.display = 'none';\n\t\t\t$imgs[i].className        = 'angle fr';\n\t\t}\n\t}\n\n});\n\n/* @require ./style.less */\nmodule.exports = {component: component};\n\n")])]),e("h1",{attrs:{id:"事件委托简单例子"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#事件委托简单例子","aria-hidden":"true"}},[t._v("#")]),t._v(" 事件委托简单例子")]),e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<!DOCTYPE html>\n<html lang="zh-cn">\n<head>\n  <meta charset="utf-8">\n  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">\n  <title>钱隆归来了</title>\n  <style media="screen">\n    ul{\n      list-style: none;\n      background:#ff0;\n\n    }\n    ul li{\n      padding:10px 0;\n      background:#cdcdcd;\n      border-bottom:1px solid #ddd;\n    }\n  </style>\n</head>\n<body>\n  <div id="app">\n    <ul id="ul">\n      <li>\n          <p>\n            li里面的p\n            <span>span1</span>\n            <span>span2</span>\n            <span>span3</span>\n          </p>\n      </li>\n      <li>222</li>\n      <li>333</li>\n      <li>444</li>\n    </ul>\n  </div>\n</body>\n<script type="text/javascript">\nwindow.onload=function(){\n  //循环li\n  \n  var ul=document.getElementById("ul")\n  ul.onclick=function(event){\n      console.log(this)\n      console.log(event)\n      console.log(event.nodeName)\n      var ev = ev || window.event;\n　　  var target = ev.target || ev.srcElement;\n　　  if(target.nodeName.toLowerCase() == \'li\'||target.nodeName.toLowerCase() == \'p\'||target.nodeName.toLowerCase() == \'span\'){\n  　　　 alert(\'触发了li\');\n　　   }\n  }\n}\n<\/script>\n</html>\n')])]),e("h1",{attrs:{id:"使用事件委托实现vue手风琴组件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用事件委托实现vue手风琴组件","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用事件委托实现vue手风琴组件")]),e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("html：\n<ul class=\"daily daliprob\" @click=\"toggle($event)\" >\n\n\n\nimport * as iakit from 'iakit'\nimport { queryInterestListInfo, interestDetailInfo } from 'services'\nimport create from './index.tpl'\nimport './index.styl'\nimport isReachBottom from 'helper/isReachBottom'\n\nexport default create({\n  data() {\n    return {\n      listData: [],\n      detailInfo: [],\n      current: {\n        basic: {},\n        newcomer: [],\n        new_come_rate: '',\n        activity: [],\n        commission: []\n      },\n      rate: 0,\n      page: 1,\n      // 是否有更多数据\n      hasMore: true,\n      // 是否显示加载更多数据信息\n      isShowLoading: true\n    }\n  },\n’\n  created() {\n    this.queryInterestList()\n    // 为窗体添加滚动事件 RreachBottom,判断是否滑动到了页面底部\n    window.addEventListener('scroll', this.RreachBottom)\n  },\n\n  methods: {\n    getNode(node) {\n      if (node.nodeName === 'LI') {\n        return node\n      } else if (node.nodeName === 'UL') {\n        return false\n      } else {\n        return this.getNode(node.parentNode)\n      }\n    },\n\n    toggle(e) {\n      var target = e.target || e.srcElement\n      var $li = document.querySelectorAll('li')\n      // thisLi 当前点击li的e.target\n      var thisLi = this.getNode(target)\n      // 获取所有列表项，生成数组\n      var $details = document.querySelectorAll('.earnDetail')\n      // 获取所有旋转图标，生成数组\n      var $icons = document.querySelectorAll('.eranIcon')\n      for (let i = 0, length = $li.length; i < length; i++) {\n        if (thisLi === $li[i]) {\n          if ($details[i].style.display === '') {\n            // div展开时，将它隐藏\n            $details[i].style.display = 'none'\n            $icons[i].className = 'eranIcon'\n          } else {\n            // 隐藏时，将它展开\n            // 如果当前详情项数组里无对应此项数据\n            if (!this.detailInfo[i]) {\n              let ctime = thisLi.children[0].children[0].innerHTML\n              interestDetailInfo(\n                {\n                  'data': ctime\n                }\n              ).then((resp) => {\n                // 将请求到的详情项放入详情数组中\n                this.detailInfo[i] = resp\n                // 将请求详情项赋值给当前详情项，以供显示\n                this.current = resp\n                if (!this.activity) {\n                  this.rate = 0\n                } else {\n                  this.rate = this.activity.rate\n                }\n              }).catch((err) => {\n                iakit.alert('', err.message, [\n                  {\n                    text: '朕知道了'\n                  }\n                ])\n              })\n            } else {\n              // 如果详情项数组中有对应此项数据，就将数组中的数据赋值给当前详情项，以供显示\n              this.current = this.detailInfo[i]\n            }\n            $details[i].style.display = ''\n            $icons[i].className = 'eranIcon rotate'\n          }\n        } else {\n          $details[i].style.display = 'none'\n          $icons[i].className = 'eranIcon'\n        }\n      }\n    },\n\n    queryInterestList() {\n      // 判断数据是否正在加载中，以防重复加载\n      if (this.fetching) {\n        return\n      }\n      this.fetching = true\n      this.isShowLoading = true\n      this.loadingTip = '正在加载中...'\n      queryInterestListInfo({\n        page: this.page,\n        len: 15\n      }).then((resp) => {\n        const data = resp.list\n        // 成功后不显示提示信息，数据加载完毕\n        this.isShowLoading = false\n        this.fetching = false\n        if (data && data.length > 0) { // 存在数据，用concat连接每次请求的数组项\n          this.listData = this.listData.concat(data)\n        } else { // 没有更多数据了\n          this.hasMore = false\n          this.isShowLoading = true\n          this.loadingTip = '没有更多数据了'\n        }\n        // 请求页标志加1,即当再次请求时请求下一页\n        this.page += 1\n      }).catch((err) => {\n        this.fetching = false\n        iakit.alert('', err.message, [\n          {\n            text: '朕知道了'\n          }\n        ])\n      })\n    },\n\n    RreachBottom() {\n      // 如果滚动到页面底部，并且当前选项卡为投资项\n      if (isReachBottom()) {\n        // 判断接口还有无数据 ，如果有，就再次请求接口\n        if (this.hasMore) {\n          this.queryInterestList()\n        } else {\n          // 如果没有数据，就解绑此事件\n          window.onscroll = null\n        }\n      }\n    }\n  }\n})\n\n")])])])}],!1,null,null,null);n.default=a.exports}}]);